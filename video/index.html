<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Custom Video Player</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
		integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
		crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        * {
  box-sizing: border-box;
  outline: none;
}
body {
  margin: 0;
}
.flex {
  display: flex;
}
.flex-space {
  display: flex;
  justify-content: space-between;
}
.container {
  padding: 1em 0;
}
#video {
  width: 100%;
}
.hide {
  display: none;
}
.videoContainer {
  width: 60%;
  margin: 0 auto;
}
.controls_of_video {
  margin: 0 auto;
  padding: 0 0.5em;
  background-color: rgba(128, 128, 128, 0.3);
  width: 60%;
}
.progress-container {
  align-items: center;
  /*border: 1px solid blue;*/
}
.video_controls_system {
  flex-direction: row;
  /*border: 1px solid green ;*/
  align-items: center;
}

/*progress bar*/
#progress-bar {
  position: relative;
  width: 85%;
  height: 5px;
  background-color: #888;
  margin: 1em 0;
  vertical-align: 2px;
  border-radius: 3px;
  cursor: pointer;
}

#currentProgress {
  position: absolute;
  left: 0;
  display: inline-block;
  height: 5px;
  width: 50%;
  background: #1434a4;
}

#currentProgress::after {
  content: '';
  position: absolute;
  left: 100%;
  top: -1px;
  width: 3px;
  height: 7px;
  background-color: #000;
}
/*control system*/
.contol_Button,
#screen_expand,
#screen_compress {
  width: 3em;
  height: 3em;
  outline: none;
  border: none;
  background-color: transparent;
}
#sizeScreen {
  margin-left: auto;
}
.volume {
  align-items: center;
  margin-left: 0.6em;
  /* border: 1px solid #1434a4; */
}
#volume-range {
  margin: 0 0.5em;
  cursor: pointer;
  height: 5px;
}
.fa-solid {
  font-size: 1.1rem;
}
@media all and (display-mode: fullscreen) {
  .container {
    padding: 0;
  }
  .videoContainer {
    width: 100%;
    margin: 0;
  }
  .controls_of_video {
    /* background-color: rgba(200, 200, 200, 0.3); */
    position: absolute;
    display: block;
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 2;
    color: #ddd;
  }
  #progress-bar {
    width: 90%;
    background-color: #555;
  }
  .fa-solid {
    color: #ddd;
  }
}

@media only screen and (max-width: 768px) {
  .videoContainer,
  .controls_of_video {
    width: 100%;
  }
  #progress-bar {
    width: 75%;
  }
  span {
    display: inline;
  }
  .song-timer {
    font-size: 0.8rem;
  }
  .fa-solid {
    font-size: 1rem;
  }
  .contol_Button,
  #screen_expand,
  #screen_compress {
    width: 2em;
    height: 1.5em;
  }
}

</style>
</head>

<body>

	<div class="container">
		<div class="videoContainer" id="videoContainer">
			<video id="video" src="./Video/Ed_Sheeran_Perfect.mp4" type="video/mp4">
				<!-- <source src="" > -->
				Your browser does not support the video tag.
			</video>

		</div>
		<div class="controls_of_video" id="controls">
			<div class="progress-container flex-space">
				<div id="progress-bar">
					<div id="currentProgress"></div>
				</div>
				<div class="song-timer">
					<span id="current-time">00:00</span>
					<span> / </span>
					<span id="max-duration">00:00</span>
				</div>
			</div>

			<div id="videoControls" class="video_controls_system flex">
				<div class="play_pause_button" id="">
					<!-- play video -->
					<button id="playButton" class="contol_Button">
						<i class="fa-solid fa-play"></i>
					</button>
					<!-- pause the video  -->
					<button id="pauseButton" class="contol_Button hide">
						<i class="fa-solid fa-pause"></i>
					</button>
				</div>
				<!-- volume of video -->
				<div id="volume" class="volume flex">
					<span class="" id="high"><i class="fa-solid fa-volume-high"></i></span>

					<span class="hide" id="low"><i class="fa-solid fa-volume-low"></i></span>

					<span class="hide" id="mute"><i class="fa-solid fa-volume-xmark"></i></span>

					<input type="range" min="0" max="100" value="50" id="volume-range">

					<span id="volume_num">50</span>
				</div>
				<!-- screen size -->
				<div id="sizeScreen">
					<button id="screen_expand" class="screen_size">
						<i class="fa-solid fa-expand"></i>
					</button>
					<button id="screen_compress" class="screen_size hide">
						<i class="fa-solid fa-compress"></i>
					</button>
				</div>
			</div>
		</div>
	</div>



	<script type="text/javascript" >
        // video
let videoContainer = document.querySelector('#videoContainer');
let video = document.getElementById('video');
let container = document.querySelector('.container');
// controls
let videoControls = document.querySelector('.controls_of_video');
// play and pause
let playButton = document.getElementById('playButton');
let pauseButton = document.getElementById('pauseButton');
// Volume
let volume = document.getElementById('volume');
let volume_range = document.getElementById('volume-range');
let volume_num = document.getElementById('volume_num');
let high = document.getElementById('high');
let low = document.getElementById('low');
let mute = document.getElementById('mute');
//Screen size
let sizeScreen = document.getElementById('sizeScreen');
let screen_compress = document.getElementById('screen_compress');
let screen_expand = document.getElementById('screen_expand');
// progress
const currentProgress = document.getElementById('currentProgress');
const currentTimeRef = document.getElementById('current-time');
const maxDuration = document.getElementById('max-duration');
const progressBar = document.getElementById('progress-bar');

//events object
let events = {
  mouse: {
    click: 'click',
  },
  touch: {
    click: 'touchstart',
  },
};
let deviceType = '';

//Detect touch device
const is_touch_device = () => {
  try {
    //We try to create TouchEvent (it would fail for desktops and throw error)
    document.createEvent('TouchEvent');
    deviceType = 'touch';
    return true;
  } catch (e) {
    deviceType = 'mouse';
    return false;
  }
};

// play and pause button
playButton.addEventListener('click', () => {
  video.play();
  pauseButton.classList.remove('hide');
  playButton.classList.add('hide');
});

pauseButton.addEventListener('click', () => {
  video.pause();
  pauseButton.classList.add('hide');
  playButton.classList.remove('hide');
});
//mute the video
const muter = () => {
  mute.classList.remove('hide');
  high.classList.add('hide');
  low.classList.add('hide');
  video.volume = 0;
  volume_num.innerHTML = 0;
  volume_range.value = 0;
};
//when user click on high and low volume then mute the audio
high.addEventListener('click', muter);
low.addEventListener('click', muter);
// for volume
volume_range.addEventListener('input', () => {
  //for converting % to decimal values since video.volume would accept decimals only
  let volumeValue = volume_range.value / 100;
  video.volume = volumeValue;
  volume_num.innerHTML = volume_range.value;
  //mute icon, low volume, high volume icons
  if (volume_range.value == 0) {
    muter();
  } else if (volume_range.value < 50) {
    low.classList.remove('hide');
    high.classList.add('hide');
    mute.classList.add('hide');
  } else if (volume_range.value > 50) {
    high.classList.remove('hide');
    mute.classList.add('hide');
    low.classList.add('hide');
  }
});

//Screen size
screen_expand.addEventListener('click', () => {
  screen_compress.classList.remove('hide');
  screen_expand.classList.add('hide');
  //fullscreen
  container.requestFullscreen();
  if (is_touch_device) {
    let screenOrientation = window.screen.orientation;
    screenOrientation
      .lock('landscape')
      .then(() => {
        alert('Yo');
      })
      .catch((error) => console.log(error));
  }
});
//if user presses escape the browser fire 'fullscreenchange' event
document.addEventListener('fullscreenchange', exitHandler);
document.addEventListener('webkitfullscreenchange', exitHandler);
document.addEventListener('mozfullscreenchange', exitHandler);
document.addEventListener('MSFullscreenChange', exitHandler);

function exitHandler() {
  //if fullscreen is closed
  if (
    !document.fullscreenElement &&
    !document.webkitIsFullScreen &&
    !document.mozFullScreen &&
    !document.msFullscreenElement
  ) {
    normalScreen();
  }
}
//back to normal screen
screen_compress.addEventListener(
  'click',
  (normalScreen = () => {
    screen_compress.classList.add('hide');
    screen_expand.classList.remove('hide');
    if (document.fullscreenElement) {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      } else if (document.mozCancelFullScreen) {
        document.mozCancelFullScreen();
      } else if (document.webkitExitFullscreen) {
        document.webkitExitFullscreen();
      }
    }
  })
);

//Format time(convert ms to seconds, minutes and add 0 if less than 10)
const timeFormatter = (timeInput) => {
  let minute = Math.floor(timeInput / 60);
  minute = minute < 10 ? '0' + minute : minute;
  let second = Math.floor(timeInput % 60);
  second = second < 10 ? '0' + second : second;
  return `${minute}:${second}`;
};
//update progress every second
setInterval(() => {
  currentTimeRef.innerHTML = timeFormatter(video.currentTime);
  currentProgress.style.width =
    (video.currentTime / video.duration.toFixed(3)) * 100 + '%';
}, 1000);
//update timer
video.addEventListener('timeupdate', () => {
  currentTimeRef.innerText = timeFormatter(video.currentTime);
});

//if user clicks on progress bar
is_touch_device();
progressBar.addEventListener(events[deviceType].click, (event) => {
  //start of progressBar
  let coordStart = progressBar.getBoundingClientRect().left;
  //mouse click position
  let coordEnd = !is_touch_device() ? event.clientX : event.touches[0].clientX;
  let progress = (coordEnd - coordStart) / progressBar.offsetWidth;
  //set width to progress
  currentProgress.style.width = progress * 100 + '%';
  //set time
  video.currentTime = progress * video.duration;
  //play
  video.play();
  pauseButton.classList.remove('hide');
  playButton.classList.add('hide');
});

window.onload = () => {
  //display duration
  maxDuration.innerText = timeFormatter(video.duration);
};

    </script>
</body>

</html>
